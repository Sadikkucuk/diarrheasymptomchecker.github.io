<!doctype html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-C4SV7HGYM6"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date()); gtag('config', 'G-C4SV7HGYM6');
  </script>

  <title>Diplopia (Double Vision) Symptom Checker (Prototype) â€“ Educational, Not Medical Advice</title>
  <meta charset="utf-8" />
  <meta name="description" content="Educational diplopia (double vision) checker that estimates possible causes from selected signs & symptoms. Not medical advice.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="canonical" href="https://sadikkucuk.github.io/diarrheasymptomchecker.github.io/diplopia.html">

  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="website">
  <meta property="og:title" content="Diplopia (Double Vision) Symptom Checker (Prototype)">
  <meta property="og:description" content="Select symptoms and see an educational estimate of possible causes of double vision. Not medical advice.">
  <meta property="og:url" content="https://sadikkucuk.github.io/diarrheasymptomchecker.github.io/diplopia.html">
  <meta property="og:image" content="https://sadikkucuk.github.io/diarrheasymptomchecker.github.io/og-image.png">
  <meta name="twitter:card" content="summary_large_image">

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "Diplopia (Double Vision) Symptom Checker (Prototype)",
    "url": "https://sadikkucuk.github.io/diarrheasymptomchecker.github.io/diplopia.html",
    "applicationCategory": "HealthApplication",
    "description": "Educational symptom checker that estimates possible diplopia causes based on selected signs/symptoms. Not medical advice.",
    "creator": { "@type": "Person", "name": "SadÄ±k KÃ¼Ã§Ã¼k" }
  }
  </script>

  <!-- Same style as your other pages -->
  <style>
    :root{--bg:#0b1020;--card:#121934;--text:#e7ebff;--muted:#9aa4c7;--accent:#5fa8ff}
    html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif}
    a{color:var(--accent);text-decoration:none}
    .wrap{max-width:1100px;margin:40px auto;padding:0 16px}
    .card{background:var(--card);border-radius:18px;padding:24px;box-shadow:0 10px 30px rgba(0,0,0,.25)}
    h1{margin:.2em 0 0.2em;font-size:28px}
    h2{margin-top:28px;font-size:20px;color:var(--muted)}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(270px,1fr));gap:16px}
    .symptom{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);padding:14px;border-radius:14px}
    .symptom label{display:block;font-weight:600;margin-bottom:8px}
    .muted{color:var(--muted)}
    .btn{appearance:none;border:none;background:var(--accent);color:#07213d;font-weight:800;padding:12px 18px;border-radius:12px;cursor:pointer;font-size:16px}
    .btn:active{transform:translateY(1px)}
    .footer{font-size:12px;color:var(--muted);margin-top:16px}
    .result{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);padding:16px;border-radius:14px}
    .row{display:flex;align-items:center;gap:10px;margin:8px 0}
    .bar{height:10px;border-radius:8px;background:rgba(255,255,255,.12);flex:1;overflow:hidden}
    .bar > span{display:block;height:100%;background:var(--accent)}
    .tag{display:inline-block;background:rgba(255,255,255,.1);padding:2px 8px;border-radius:999px;font-size:11px;margin-left:6px;color:#d7e7ff}
    details{background:rgba(255,255,255,.04);border:1px solid rgba(255,255,255,.08);padding:12px 14px;border-radius:14px}
    summary{cursor:pointer}
    .yesno{display:flex;gap:14px;margin-top:6px}
    .chips{display:flex;flex-wrap:wrap;gap:6px;margin:10px 0}
    .chip{background:rgba(255,255,255,.08);border:1px solid rgba(255,255,255,.1);padding:4px 8px;border-radius:999px;font-size:12px}
    .topnav{margin-bottom:8px}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
<div class="topnav muted">
  <a href="./index.html">Diarrhea</a> â€¢
  <a href="./abdominal-distension.html">Abdominal Distension</a> â€¢
  <a href="./abdominal-pain.html">Abdominal Pain</a> â€¢
  <a href="./aerophagia.html">Aerophagia</a> â€¢
  <a href="./anemia.html">Anemia</a> â€¢
  <a href="./arthralgia.html">Arthralgia</a> â€¢
  <a href="./back-pain.html">Back Pain</a> â€¢
  <a href="./belching.html">Belching</a> â€¢
  <a href="./cholecystitis.html">Cholecystitis</a> â€¢
  <a href="./conjunctivitis.html">Conjunctivitis</a> â€¢
  <a href="./constipation.html">Constipation</a> â€¢
  <a href="./cough.html">Cough</a> â€¢
  <a href="./cyanosis.html">Cyanosis</a> â€¢
  <a href="./cystitis.html">Cystitis</a> â€¢
  <a href="./dehydration.html">Dehydration</a> â€¢
  <a href="./diplopia.html">Diplopia</a> â€¢
  <a href="./dyspepsia.html">Dyspepsia</a> â€¢
  <a href="./dyspnea.html">Dyspnea</a> â€¢
  <a href="./epistaxis.html">Epistaxis</a> â€¢
  <a href="./fatigue.html">Fatigue</a> â€¢
  <a href="./flatulence.html">Flatulence</a> â€¢
  <a href="./flushing.html">Flushing</a> â€¢
  <a href="./frequent-urination.html">Frequent Urination</a> â€¢
  <a href="./gastritis.html">Gastritis</a> â€¢
  <a href="./gastroenteritis.html">Gastroenteritis</a> â€¢
  <a href="./gerd.html">GERD</a> â€¢
  <a href="./headache.html">Headache</a> â€¢
  <a href="./hoarse-voice.html">Hoarse Voice</a> â€¢
  <a href="./hyperthyroidism.html">Hyperthyroidism</a> â€¢
  <a href="./hypothyroidism.html">Hypothyroidism</a> â€¢
  <a href="./jaundice.html">Jaundice</a> â€¢
  <a href="./laryngitis.html">Laryngitis</a> â€¢
  <a href="./lightheadedness.html">Lightheadedness</a> â€¢
  <a href="./nocturia.html">Nocturia</a> â€¢
  <a href="./otitis-externa.html">Otitis Externa</a> â€¢
  <a href="./otitis-media.html">Otitis Media</a> â€¢
  <a href="./palpitations.html">Palpitations</a> â€¢
  <a href="./pancreatitis.html">Pancreatitis</a> â€¢
  <a href="./peptic-ulcer-disease.html">Peptic Ulcer Disease</a> â€¢
  <a href="./photophobia.html">Photophobia</a> â€¢
  <a href="./photopsia.html">Photopsia</a> â€¢
  <a href="./pneumonia.html">Pneumonia</a> â€¢
  <a href="./polyuria.html">Polyuria</a> â€¢
  <a href="./pruritus.html">Pruritus</a> â€¢
  <a href="./pyelonephritis.html">Pyelonephritis</a> â€¢
  <a href="./rhinorrhea.html">Rhinorrhea</a> â€¢
  <a href="./sinusitis.html">Sinusitis</a> â€¢
  <a href="./sore-throat.html">Sore Throat</a> â€¢
  <a href="./syncope.html">Syncope</a> â€¢
  <a href="./tonsillitis.html">Tonsillitis</a> â€¢
  <a href="./toothache.html">Toothache</a> â€¢
  <a href="./tremor.html">Tremor</a> â€¢
  <a href="./urinary-retention.html">Urinary Retention</a> â€¢
  <a href="./uti.html">UTI</a> â€¢
  <a href="./vomiting.html">Vomiting</a> â€¢
  <a href="./xerostomia.html">Xerostomia</a>
</div>

      <h1>Diplopia (Double Vision) Cause Estimator <span class="tag">prototype</span></h1>
      <p class="muted">Educational demo â€” not medical advice. <strong>Red flags:</strong> sudden double vision with severe headache, droopy eyelid or dilated pupil, eye pain with fever, new weakness/numbness/vertigo, or after trauma. Seek urgent care for red flags.</p>

      <h2>1) Select your signs & symptoms</h2>
      <p class="muted">Choose <strong>Yes</strong> for symptoms that apply to you now.</p>
      <div id="symptomGrid" class="grid"></div>

      <div style="margin-top:18px;display:flex;gap:12px;align-items:center">
        <button class="btn" id="nextBtn">Next â†’ Calculate</button>
        <span class="muted" id="selectedCount"></span>
      </div>

      <h2>2) Estimated likelihood by cause</h2>
      <div id="results" class="result"></div>

      <details style="margin-top:14px">
        <summary><strong>How this works</strong></summary>
        <p class="muted">We compare your selections to typical symptom sets from medical encyclopedias. Each cause gets a score = matches Ã· that causeâ€™s total listed symptoms, normalized to 100%. This is a naive overlap metric â€” not a diagnosis.</p>
      </details>
      <div class="footer">v0.1 â€¢ Built for learning</div>
    </div>
  </div>

<script>
/* ====== API (server-scored) ====== */
const API_URL = "https://billowing-wind-92bc.sadik-kucuk3739342.workers.dev/estimate-diplopia";

/* ====== CLIENT-SIDE SYMPTOM LIST (safe to expose) ====== */
const SYMPTOMS = [
  // Core & classification
  "double vision (diplopia)","binocular diplopia (resolves closing either eye)","monocular diplopia (persists one eye closed)",
  "sudden onset","intermittent/fluctuating","worse when tired (evenings)",
  "horizontal diplopia","vertical diplopia","oblique/diagonal diplopia",
  "worse at distance (driving)","worse at near (reading)","head tilt helps",

  // Eye movement & positions
  "worse when looking to the right","worse when looking to the left","worse when looking up","worse when looking down / down stairs",

  // Ocular signs/symptoms
  "eye pain","pain with eye movement","droopy eyelid (ptosis)","pupil asymmetry (anisocoria)","red swollen eyelids",
  "bulging eye (proptosis)","lid retraction/lag","red eye","blurred vision","vision loss",

  // Context & exposures
  "recent head trauma","recent sinus infection","recent viral illness","contact lens use",

  // Neuro/systemic clues
  "severe headache","vertigo","dysarthria or trouble speaking","limb weakness or numbness","unsteady walking/ataxia","fever",

  // History
  "diabetes","high blood pressure (hypertension)","thyroid disease or hyperthyroidism","history of multiple sclerosis","history of myasthenia gravis","cancer history"
].sort((a,b)=> a.localeCompare(b));

/* ====== BUILD THE UI ====== */
const grid = document.getElementById('symptomGrid');
const selCount = document.getElementById('selectedCount');
function buildGrid(){
  grid.innerHTML = '';
  SYMPTOMS.forEach((sym, idx) => {
    const idYes = `sym-${idx}-yes`, idNo = `sym-${idx}-no`;
    const box = document.createElement('div');
    box.className = 'symptom';
    box.innerHTML = `
      <label>${sym}</label>
      <div class="yesno">
        <label><input type="radio" name="sym-${idx}" value="yes" id="${idYes}"> Yes</label>
        <label><input type="radio" name="sym-${idx}" value="no" id="${idNo}" checked> No</label>
      </div>`;
    grid.appendChild(box);
  });
}
buildGrid();

/* ====== READ SELECTION ====== */
function getSelectedSymptoms(){
  const chosen = [];
  const groups = new Map();
  [...document.querySelectorAll('input[type=radio]')].forEach(r=>{
    const key = r.name; if(!groups.has(key)) groups.set(key, []); groups.get(key).push(r);
  });
  groups.forEach((radios)=>{
    const yes = radios.find(r=>r.value==='yes' && r.checked);
    if(yes){
      const idx = parseInt(yes.id.split('-')[1],10);
      chosen.push(SYMPTOMS[idx]);
    }
  });
  return chosen;
}

/* ====== RENDER RESULTS ====== */
function render(items, chosen){
  const res = document.getElementById('results');
  res.innerHTML = '';
  items.forEach(item=>{
    const pct = (item.prob*100).toFixed(1);
    const row = document.createElement('div');
    row.className = 'row';
    row.innerHTML = `
      <div style="min-width:260px"><strong>${item.cause}</strong>
        <span class="muted">(${item.matches}/${item.total} match)</span></div>
      <div class="bar"><span style="width:${pct}%"></span></div>
      <div style="min-width:60px;text-align:right"><strong>${pct}%</strong></div>`;
    res.appendChild(row);
  });
  const chips = document.createElement('div');
  chips.className = 'chips';
  chips.innerHTML = chosen.map(s=>`<span class="chip">${s}</span>`).join('');
  res.appendChild(chips);
}

/* ====== CALL CLOUDFLARE WORKER ====== */
async function calculate(){
  const chosen = getSelectedSymptoms();
  selCount.textContent = chosen.length ? `${chosen.length} symptom(s) selected` : 'No symptoms selected yet';

  const res = document.getElementById('results');
  res.innerHTML = '<p class="muted">Calculatingâ€¦</p>';

  try{
    const resp = await fetch(API_URL, {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({ symptoms: chosen })
    });
    const data = await resp.json();
    if (!resp.ok || data.error) throw new Error(data.error || 'Server error');

    const items = data.items || [];
    if(!items.length || items.every(x=>x.prob===0)){
      res.innerHTML = '<p class="muted">No overlap yet. Try selecting a few symptoms above.</p>';
      return;
    }
    render(items, chosen);
  }catch(e){
    res.innerHTML = '<p class="muted">Network or server error. Please try again.</p>';
    console.error(e);
  }
}
document.getElementById('nextBtn').addEventListener('click', calculate);
</script>

<!-- Optional: Buy Me a Coffee widget -->
<script data-name="BMC-Widget" data-cfasync="false"
  src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js"
  data-id="sadikkucuk"
  data-description="Support my work"
  data-message="If this tool helps you, you can buy me a coffee ðŸ™‚"
  data-color="#FFDD00"
  data-position="Right"
  data-x_margin="18"
  data_y_margin="18"></script>
</body>
</html>
