<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<title>Comprehensive Scope — PDF & Word (Text Only)</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="Fill the scope form, tick checklists, export clean text-only PDF or DOCX (no tables/boxes)." />
<link rel="preconnect" href="https://cdn.jsdelivr.net">
<style>
  :root{
    --bg:#0b0f14; --panel:#121922; --text:#eaf0f7; --muted:#8da0b8; --border:#273446;
    --paper:#ffffff; --ink:#111827; --sub:#465468;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{margin:0;background:linear-gradient(180deg,#0b0f14,#0f1520);color:var(--text);font:15px/1.55 system-ui,Segoe UI,Roboto,Inter,Arial,sans-serif}
  header{max-width:1200px;margin:18px auto 0;padding:0 16px}
  h1{margin:0 0 6px;font-weight:700;font-size:24px}
  .sub{margin:0 0 14px;color:var(--muted)}
  main{max-width:1200px;margin:0 auto 80px;padding:0 16px;display:grid;grid-template-columns: 1.05fr 1fr;gap:18px}
  @media (max-width: 980px){ main{grid-template-columns:1fr} }
  .card{background:var(--panel);border:1px solid var(--border);border-radius:14px;box-shadow:0 10px 24px rgba(0,0,0,.35)}
  .pad{padding:14px}
  .toolbar{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
  button{
    padding:8px 12px;border-radius:10px;border:1px solid var(--border);background:#122033;color:var(--text);
    cursor:pointer;transition:.15s transform ease
  }
  button:hover{transform:translateY(-1px)}
  button.primary{background:linear-gradient(180deg,#24466d,#1b3553);border-color:#33537b}
  button.ghost{background:transparent}
  .small{font-size:12px;color:var(--muted)}
  .section{border-top:1px dashed var(--border);padding-top:12px;margin-top:12px}
  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  label{display:block;margin:8px 0 4px;color:#cfe0ff;font-size:13px}
  input[type=text], input[type=date], textarea{
    width:100%;padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:#0f1722;color:var(--text);
  }
  textarea{min-height:84px;resize:vertical}
  .chkline{display:flex;align-items:flex-start;gap:8px;margin:6px 0}
  .chkline input{margin-top:2px}
  .scroll{max-height:65vh;overflow:auto;border-radius:0 0 14px 14px}
  .sticky{position:sticky;top:0;background:var(--panel);z-index:3;border-bottom:1px solid var(--border)}

  /* Printable preview (RIGHT) — TEXT ONLY, no boxes or tables */
  .paperHost{position:relative}
  .paper{
    background:var(--paper); color:var(--ink);
    width:210mm; min-height:297mm; margin:12px auto;
    box-shadow:0 8px 30px rgba(0,0,0,.35);
    border-radius:6px; padding:18mm 16mm 28mm;
  }
  .title{font-size:18pt;font-weight:800;margin:0}
  .subtitle{color:var(--sub);margin:.5mm 0 8mm}
  .h2{font-weight:800;font-size:13.5pt;margin:9mm 0 2.5mm}
  .h3{font-weight:700;font-size:12pt;margin:4.5mm 0 2mm}
  .pair{margin:1mm 0 1mm; font-size:11pt}
  .pair b{font-weight:700}
  .para{margin:1.5mm 0 3mm; white-space:pre-wrap; font-size:11pt}
  .checkrow{display:flex;gap:6px;align-items:flex-start;margin:1mm 0;font-size:11pt}
  .checkmark{width:12px;text-align:center;display:inline-block}
  .pagebreak{page-break-before:always; break-before:page;}
  /* keep elements together at page ends */
  .pair, .para, .h3, .checkrow { break-inside: avoid; page-break-inside: avoid; }
</style>
</head>
<body>
<header>
  <h1>Comprehensive Scope — Form ➜ PDF/DOCX (Text-Only)</h1>
  <p class="sub">Fill on the left, clean text layout on the right. Export PDF or DOCX without tables/boxes.</p>
</header>

<main>
  <!-- LEFT: FORM -->
  <section class="card">
    <div class="pad sticky">
      <div class="toolbar">
        <button id="btnPdf" class="primary">Export PDF</button>
        <button id="btnWord" class="primary">Export Word (.docx)</button>
        <button id="btnClear" class="ghost">Clear</button>
        <span class="small">Your inputs mirror to the preview instantly.</span>
      </div>
    </div>
    <div class="pad scroll">

      <div class="section">
        <h3>1) Project Information</h3>
        <div class="grid2">
          <div><label>Project Name</label><input type="text" name="project_name" /></div>
          <div><label>Sponsor</label><input type="text" name="sponsor" /></div>
          <div><label>Prepared By</label><input type="text" name="prepared_by" /></div>
          <div><label>Date</label><input type="date" name="date" /></div>
        </div>
      </div>

      <div class="section">
        <h3>2) Scope Statement</h3>
        <label>Project Goal and Objectives</label><textarea name="goal_objectives"></textarea>
        <label>Project Boundaries (Within Scope)</label><textarea name="boundaries_in"></textarea>
        <label>Project Boundaries (Out of Scope)</label><textarea name="boundaries_out"></textarea>
        <label>Project Deliverables</label><textarea name="deliverables"></textarea>
        <label>Success Criteria</label><textarea name="success_criteria"></textarea>
        <label>Project Assumptions</label><textarea name="assumptions"></textarea>
        <label>Project Constraints</label><textarea name="constraints"></textarea>
      </div>

      <div class="section">
        <h3>3) Scope Dimensions</h3>

        <div class="section">
          <h4>3.1 Project Scope</h4>
          <label>Project Objectives</label><textarea name="proj_scope_objectives"></textarea>
          <label>Deliverables</label><textarea name="proj_scope_deliverables"></textarea>
          <label>Tasks & Activities</label><textarea name="proj_scope_tasks"></textarea>
          <label>Resources</label><textarea name="proj_scope_resources"></textarea>
          <label>Milestones</label><textarea name="proj_scope_milestones"></textarea>
          <label>Roles & Responsibilities</label><textarea name="proj_scope_roles"></textarea>
        </div>

        <div class="section">
          <h4>3.2 Product Scope</h4>
          <label>Product/Service Name</label><input type="text" name="product_name" />
          <label>Product Objectives</label><textarea name="product_objectives"></textarea>
          <label>Features & Functions</label><textarea name="product_features"></textarea>
          <label>Success Criteria</label><textarea name="product_success"></textarea>
          <label>Out of Scope</label><textarea name="product_out"></textarea>
        </div>

        <div class="section">
          <h4>3.3 Functional Scope</h4>
          <label>Functional Requirements</label><textarea name="func_reqs"></textarea>
          <label>User Stories / Use Cases</label><textarea name="user_stories"></textarea>
          <label>Business Rules</label><textarea name="biz_rules"></textarea>
          <label>Acceptance Criteria</label><textarea name="acceptance_criteria"></textarea>
          <label>Dependencies</label><textarea name="dependencies"></textarea>
        </div>

        <div class="section">
          <h4>3.4 Technical Scope</h4>
          <label>Systems Involved</label><textarea name="systems_involved"></textarea>
          <label>Architecture & Platforms</label><textarea name="architecture"></textarea>
          <label>Interfaces & APIs</label><textarea name="interfaces"></textarea>
          <label>Data Requirements</label><textarea name="data_requirements"></textarea>
          <label>Constraints</label><textarea name="tech_constraints"></textarea>
        </div>

        <div class="section">
          <h4>3.5 Organizational Scope</h4>
          <label>Impacted Units/Departments</label><textarea name="impacted_units"></textarea>
          <label>Stakeholder Groups</label><textarea name="stakeholder_groups"></textarea>
          <label>Locations</label><textarea name="locations"></textarea>
          <label>Organizational Changes</label><textarea name="org_changes"></textarea>
          <label>Training & Communication Needs</label><textarea name="training_comm"></textarea>
        </div>
      </div>

      <div class="section">
        <h3>4) Scope Creep Management</h3>
        <label>Change Request Process</label><textarea name="change_process"></textarea>
        <label>Impact Assessment</label><textarea name="impact_assessment"></textarea>
        <label>Decision Authority</label><textarea name="decision_authority"></textarea>
        <label>Positive Scope Change Handling</label><textarea name="positive_scope"></textarea>
        <label>Trade-Offs</label><textarea name="tradeoffs"></textarea>
      </div>

      <div class="section">
        <h3>5) Roles & Responsibilities</h3>
        <label>Project Manager (PM) — Responsibilities</label><textarea name="pm_resp"></textarea>
        <label>Business Analyst (BA) — Responsibilities</label><textarea name="ba_resp"></textarea>
        <label>Technical Lead — Responsibilities</label><textarea name="techlead_resp"></textarea>
        <label>Stakeholders — Responsibilities</label><textarea name="stakeholders_resp"></textarea>
        <label>Governance Body (if any) — Responsibilities</label><textarea name="gov_body_resp"></textarea>
      </div>

      <div class="section">
        <h3>6) Scoping Checklist</h3>
        <div id="checklistForm"></div>
      </div>

      <div class="section">
        <h3>7) Approval & Sign-off</h3>
        <div class="grid2">
          <div>
            <label>Project Manager — Name</label><input type="text" name="sig_pm_name" />
            <label>Project Manager — Date</label><input type="date" name="sig_pm_date" />
          </div>
          <div>
            <label>Business Analyst — Name</label><input type="text" name="sig_ba_name" />
            <label>Business Analyst — Date</label><input type="date" name="sig_ba_date" />
          </div>
          <div>
            <label>Technical Lead — Name</label><input type="text" name="sig_tl_name" />
            <label>Technical Lead — Date</label><input type="date" name="sig_tl_date" />
          </div>
          <div>
            <label>Business Sponsor — Name</label><input type="text" name="sig_bs_name" />
            <label>Business Sponsor — Date</label><input type="date" name="sig_bs_date" />
          </div>
        </div>
      </div>

    </div>
  </section>

  <!-- RIGHT: PRINT PREVIEW (TEXT ONLY) -->
  <section class="card paperHost">
    <div id="paper" class="paper">
      <h2 class="title">Comprehensive Scope Document</h2>
      <div class="subtitle">Generated: <span data-field="date_print"></span></div>

      <div class="h2">1. Project Information</div>
      <div class="pair"><b>Project Name:</b> <span data-field="project_name_out"></span></div>
      <div class="pair"><b>Sponsor:</b> <span data-field="sponsor_out"></span></div>
      <div class="pair"><b>Prepared By:</b> <span data-field="prepared_by_out"></span></div>
      <div class="pair"><b>Date:</b> <span data-field="date_out"></span></div>

      <div class="h2">2. Scope Statement</div>
      <div class="h3">Project Goal and Objectives</div><div class="para" data-field="goal_objectives_out"></div>
      <div class="h3">Project Boundaries (Within Scope)</div><div class="para" data-field="boundaries_in_out"></div>
      <div class="h3">Project Boundaries (Out of Scope)</div><div class="para" data-field="boundaries_out_out"></div>
      <div class="h3">Project Deliverables</div><div class="para" data-field="deliverables_out"></div>
      <div class="h3">Success Criteria</div><div class="para" data-field="success_criteria_out"></div>
      <div class="h3">Project Assumptions</div><div class="para" data-field="assumptions_out"></div>
      <div class="h3">Project Constraints</div><div class="para" data-field="constraints_out"></div>

      <div class="h2 pagebreak">3. Scope Dimensions</div>
      <div class="h3">3.1 Project Scope</div>
      <div class="para" data-field="proj_scope_objectives_out"></div>
      <div class="para" data-field="proj_scope_deliverables_out"></div>
      <div class="para" data-field="proj_scope_tasks_out"></div>
      <div class="para" data-field="proj_scope_resources_out"></div>
      <div class="para" data-field="proj_scope_milestones_out"></div>
      <div class="para" data-field="proj_scope_roles_out"></div>

      <div class="h3">3.2 Product Scope</div>
      <div class="pair"><b>Product/Service Name:</b> <span data-field="product_name_out"></span></div>
      <div class="para" data-field="product_objectives_out"></div>
      <div class="para" data-field="product_features_out"></div>
      <div class="para" data-field="product_success_out"></div>
      <div class="para" data-field="product_out_out"></div>

      <div class="h3">3.3 Functional Scope</div>
      <div class="para" data-field="func_reqs_out"></div>
      <div class="para" data-field="user_stories_out"></div>
      <div class="para" data-field="biz_rules_out"></div>
      <div class="para" data-field="acceptance_criteria_out"></div>
      <div class="para" data-field="dependencies_out"></div>

      <div class="h3">3.4 Technical Scope</div>
      <div class="para" data-field="systems_involved_out"></div>
      <div class="para" data-field="architecture_out"></div>
      <div class="para" data-field="interfaces_out"></div>
      <div class="para" data-field="data_requirements_out"></div>
      <div class="para" data-field="tech_constraints_out"></div>

      <div class="h3">3.5 Organizational Scope</div>
      <div class="para" data-field="impacted_units_out"></div>
      <div class="para" data-field="stakeholder_groups_out"></div>
      <div class="para" data-field="locations_out"></div>
      <div class="para" data-field="org_changes_out"></div>
      <div class="para" data-field="training_comm_out"></div>

      <div class="h2 pagebreak">4. Scope Creep Management</div>
      <div class="para" data-field="change_process_out"></div>
      <div class="para" data-field="impact_assessment_out"></div>
      <div class="para" data-field="decision_authority_out"></div>
      <div class="para" data-field="positive_scope_out"></div>
      <div class="para" data-field="tradeoffs_out"></div>

      <div class="h2">5. Roles & Responsibilities</div>
      <div class="para" data-field="pm_resp_out"></div>
      <div class="para" data-field="ba_resp_out"></div>
      <div class="para" data-field="techlead_resp_out"></div>
      <div class="para" data-field="stakeholders_resp_out"></div>
      <div class="para" data-field="gov_body_resp_out"></div>

      <div class="h2 pagebreak">6. Scoping Checklist</div>
      <div id="checklistPreview"></div>

      <div class="h2">7. Approval & Sign-off</div>
      <div class="pair"><b>Project Manager — Name:</b> <span data-field="sig_pm_name_out"></span></div>
      <div class="pair"><b>Project Manager — Date:</b> <span data-field="sig_pm_date_out"></span></div>
      <div class="pair"><b>Business Analyst — Name:</b> <span data-field="sig_ba_name_out"></span></div>
      <div class="pair"><b>Business Analyst — Date:</b> <span data-field="sig_ba_date_out"></span></div>
      <div class="pair"><b>Technical Lead — Name:</b> <span data-field="sig_tl_name_out"></span></div>
      <div class="pair"><b>Technical Lead — Date:</b> <span data-field="sig_tl_date_out"></span></div>
      <div class="pair"><b>Business Sponsor — Name:</b> <span data-field="sig_bs_name_out"></span></div>
      <div class="pair"><b>Business Sponsor — Date:</b> <span data-field="sig_bs_date_out"></span></div>
    </div>
  </section>
</main>

<!-- libs -->
<script src="https://cdn.jsdelivr.net/npm/html2pdf.js@0.10.1/dist/html2pdf.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/docx@8.5.0/build/index.umd.js"></script>

<script>
/* Checklist groups (same items) */
const CHECK_GROUPS = [
  { title: "Context and Needs", items: [
    "What is the problem/opportunity we are trying to solve?",
    "Who are we trying to solve the problem/opportunity for?",
    "How does this problem/opportunity impact the end customer?",
    "How confident are we that we understand the root cause?",
    "What options and alternatives have been discussed?",
    "Is the project looking to change customer behaviors?",
    "Is the project looking to change internal user behaviors?",
  ]},
  { title: "Value Analysis", items: [
    "Are we looking to reduce costs? In what ways? And for whom?",
    "How will it be measured?",
    "Are we looking to increase revenue?",
    "Are we looking to reduce risks? Which risks?",
    "Are we looking to be more competitive? In what ways?",
    "Are we looking to save someone time?",
    "Are we looking to provide something to customers that they don’t currently have today?",
    "Are we looking to improve the customer experience with the organization, service, or product? In what ways and how will it be measured?",
    "Are we looking to simply meet a compliance requirement? Or meet it better than competitors? Or meet it while improving the touch point with customers?",
    "What business outcomes are we looking to achieve?",
  ]},
  { title: "Ambiguity and Change", items: [
    "What are the major assumptions we or the stakeholders are making?",
    "What are the major risks from the perspective of the various teams involved?",
    "What hypothesis do we have about the project goals?",
    "What experiments need to be done to learn and reduce ambiguity?",
    "What is most likely to change during the project? (For example, requirements, regulations, stakeholders, technology, strategy, external parties)",
  ]},
  { title: "Stakeholders", items: [
    "Who is the sponsor? How engaged and available are they?",
    "Is the sponsor’s vision clear?",
    "What groups will be impacted and how? Where are they located?",
    "What groups and users will need to change, and how?",
    "What groups and users will see or experience something different as a result of the project?",
    "What end-customer touch points may change or are at risk?",
    "What external organizations, vendors, experts, and government bodies need to be consulted?",
  ]},
  { title: "Users", items: [
    "Will any users see or experience differences in their interactions with the technology or process?",
    "List the users and the specific changes.",
  ]},
  { title: "Business Processes", items: [
    "What business processes are impacted, and how?",
    "What users and user interactions/goals will change?",
    "What technologies are known to be part of these business processes?",
    "Are there new rules that will impact the process?",
    "Are job descriptions or responsibilities changing for anyone?",
  ]},
  { title: "Data", items: [
    "Is there any new data needed to make the process successful?",
    "Is any new data needed to be transmitted outside the organization?",
    "Is any new data coming into the organization?",
    "Are there any expected changes to existing data?",
  ]},
];

const checklistForm = document.getElementById('checklistForm');
const checklistPreview = document.getElementById('checklistPreview');

function buildChecklist(){
  // form side
  CHECK_GROUPS.forEach((grp, gi)=>{
    const sec = document.createElement('div');
    sec.className = 'section';
    const title = document.createElement('h4'); title.textContent = grp.title; sec.appendChild(title);
    grp.items.forEach((txt, ii)=>{
      const id = `cl_${gi}_${ii}`;
      const div = document.createElement('div');
      div.className = 'chkline';
      div.innerHTML = `<input type="checkbox" id="${id}" data-cl-key="${id}"><label for="${id}">${txt}</label>`;
      sec.appendChild(div);
    });
    checklistForm.appendChild(sec);
  });

  // preview side
  CHECK_GROUPS.forEach((grp, gi)=>{
    const h = document.createElement('div'); h.className = 'h3'; h.textContent = grp.title; checklistPreview.appendChild(h);
    grp.items.forEach((txt, ii)=>{
      const id = `cl_${gi}_${ii}`;
      const row = document.createElement('div'); row.className = 'checkrow';
      row.innerHTML = `<span class="checkmark" data-cb="${id}"></span><div>${txt}</div>`;
      checklistPreview.appendChild(row);
    });
  });
}
buildChecklist();

/* Bind inputs -> preview text spans */
const bindMap = [
  ["project_name","project_name_out"],["sponsor","sponsor_out"],["prepared_by","prepared_by_out"],["date","date_out"],
  ["goal_objectives","goal_objectives_out"],["boundaries_in","boundaries_in_out"],["boundaries_out","boundaries_out_out"],
  ["deliverables","deliverables_out"],["success_criteria","success_criteria_out"],["assumptions","assumptions_out"],["constraints","constraints_out"],
  ["proj_scope_objectives","proj_scope_objectives_out"],["proj_scope_deliverables","proj_scope_deliverables_out"],
  ["proj_scope_tasks","proj_scope_tasks_out"],["proj_scope_resources","proj_scope_resources_out"],
  ["proj_scope_milestones","proj_scope_milestones_out"],["proj_scope_roles","proj_scope_roles_out"],
  ["product_name","product_name_out"],["product_objectives","product_objectives_out"],["product_features","product_features_out"],
  ["product_success","product_success_out"],["product_out","product_out_out"],
  ["func_reqs","func_reqs_out"],["user_stories","user_stories_out"],["biz_rules","biz_rules_out"],
  ["acceptance_criteria","acceptance_criteria_out"],["dependencies","dependencies_out"],
  ["systems_involved","systems_involved_out"],["architecture","architecture_out"],["interfaces","interfaces_out"],
  ["data_requirements","data_requirements_out"],["tech_constraints","tech_constraints_out"],
  ["impacted_units","impacted_units_out"],["stakeholder_groups","stakeholder_groups_out"],["locations","locations_out"],
  ["org_changes","org_changes_out"],["training_comm","training_comm_out"],
  ["change_process","change_process_out"],["impact_assessment","impact_assessment_out"],["decision_authority","decision_authority_out"],
  ["positive_scope","positive_scope_out"],["tradeoffs","tradeoffs_out"],
  ["pm_resp","pm_resp_out"],["ba_resp","ba_resp_out"],["techlead_resp","techlead_resp_out"],
  ["stakeholders_resp","stakeholders_resp_out"],["gov_body_resp","gov_body_resp_out"],
  ["sig_pm_name","sig_pm_name_out"],["sig_pm_date","sig_pm_date_out"],
  ["sig_ba_name","sig_ba_name_out"],["sig_ba_date","sig_ba_date_out"],
  ["sig_tl_name","sig_tl_name_out"],["sig_tl_date","sig_tl_date_out"],
  ["sig_bs_name","sig_bs_name_out"],["sig_bs_date","sig_bs_date_out"],
];

function setField(outKey, value){
  const el = document.querySelector(`[data-field="${outKey}"]`);
  if(el) el.textContent = value || '';
}

function syncAll(){
  document.querySelector('[data-field="date_print"]').textContent = new Date().toLocaleString();
  bindMap.forEach(([src,dst])=>{
    const input = document.querySelector(`[name="${src}"]`);
    let val = input?.value || '';
    if(input && input.type === 'date' && val){
      try { val = new Date(val+"T00:00:00").toLocaleDateString(); } catch(e){}
    }
    setField(dst, val);
  });
  document.querySelectorAll('[data-cb]').forEach(cb=>{
    const key = cb.getAttribute('data-cb');
    cb.textContent = document.querySelector(`[data-cl-key="${key}"]`)?.checked ? "✓" : "□";
  });
}
syncAll();
document.addEventListener('input', e=>{ if(e.target.matches('input, textarea')) syncAll(); });
document.addEventListener('change', e=>{ if(e.target.matches('input[type="checkbox"]')) syncAll(); });

/* PDF (text-only) */
document.getElementById('btnPdf').addEventListener('click', ()=>{
  // Önce önizlemeyi senkronla
  syncAll();

  // Boş sayfa sebebi olan pagebreak sınıflarını export öncesi temizle
  document.querySelectorAll('.pagebreak').forEach(n => n.classList.remove('pagebreak'));

  const el = document.getElementById('paper');

  html2pdf().set({
    // tek değer (mm) verelim; üst-alt-sol-sağ aynı olsun
    margin: 10,
    filename: 'Comprehensive_Scope_Document.pdf',
    image: { type:'jpeg', quality:0.98 },
    html2canvas: { scale: 2, useCORS: true, backgroundColor: '#ffffff' },
    jsPDF: { unit:'mm', format:'a4', orientation:'portrait' },
    // 'legacy' modunu kaldır → baştaki boş sayfaları tetikliyordu
    pagebreak: { mode: ['css'], avoid: ['.para','.pair','.h3','.checkrow'] }
  }).from(el).save();
});


/* WORD (headings + paragraphs only) */
function val(name){
  const el = document.querySelector(`[name="${name}"]`);
  return (el && el.type==='date' && el.value)
    ? new Date(el.value+"T00:00:00").toLocaleDateString()
    : (el?.value || '');
}
function checklistRows(){
  const out = [];
  CHECK_GROUPS.forEach((grp, gi)=>{
    out.push({ type:'h3', text: grp.title });
    grp.items.forEach((txt, ii)=>{
      const key = `cl_${gi}_${ii}`;
      const checked = document.querySelector(`[data-cl-key="${key}"]`)?.checked;
      out.push({ type:'check', text: txt, checked });
    });
  });
  return out;
}

document.getElementById('btnWord').addEventListener('click', async ()=>{
  syncAll();
  const { Document, Packer, Paragraph, TextRun, HeadingLevel } = docx;

  const p = (text="") => new Paragraph({ children:[ new TextRun(text) ], spacing:{ after: 120 } });
  const strongLine = (label, text="") => new Paragraph({
    children:[ new TextRun({text: label + ": ", bold:true}), new TextRun(text) ],
    spacing:{ after: 120 }
  });
  const H2 = t => new Paragraph({ text:t, heading:HeadingLevel.HEADING_2, spacing:{ before:240, after:120 } });
  const H3 = t => new Paragraph({ text:t, heading:HeadingLevel.HEADING_3, spacing:{ before:160, after:90 } });

  const doc = new Document({
    sections: [{
      properties: { page: { margin: { top: 1134, bottom: 1134, left: 1134, right: 1134 } } }, // ~2cm
      children: [
        new Paragraph({ text: "Comprehensive Scope Document", heading: HeadingLevel.TITLE, spacing:{ after: 200 } }),
        strongLine("Generated", new Date().toLocaleString()),

        H2("1. Project Information"),
        strongLine("Project Name", val("project_name")),
        strongLine("Sponsor", val("sponsor")),
        strongLine("Prepared By", val("prepared_by")),
        strongLine("Date", val("date")),

        H2("2. Scope Statement"),
        H3("Project Goal and Objectives"), p(val("goal_objectives")),
        H3("Project Boundaries (Within Scope)"), p(val("boundaries_in")),
        H3("Project Boundaries (Out of Scope)"), p(val("boundaries_out")),
        H3("Project Deliverables"), p(val("deliverables")),
        H3("Success Criteria"), p(val("success_criteria")),
        H3("Project Assumptions"), p(val("assumptions")),
        H3("Project Constraints"), p(val("constraints")),

        H2("3. Scope Dimensions"),
        H3("3.1 Project Scope"),
          p(val("proj_scope_objectives")),
          p(val("proj_scope_deliverables")),
          p(val("proj_scope_tasks")),
          p(val("proj_scope_resources")),
          p(val("proj_scope_milestones")),
          p(val("proj_scope_roles")),
        H3("3.2 Product Scope"),
          strongLine("Product/Service Name", val("product_name")),
          p(val("product_objectives")),
          p(val("product_features")),
          p(val("product_success")),
          p(val("product_out")),
        H3("3.3 Functional Scope"),
          p(val("func_reqs")),
          p(val("user_stories")),
          p(val("biz_rules")),
          p(val("acceptance_criteria")),
          p(val("dependencies")),
        H3("3.4 Technical Scope"),
          p(val("systems_involved")),
          p(val("architecture")),
          p(val("interfaces")),
          p(val("data_requirements")),
          p(val("tech_constraints")),
        H3("3.5 Organizational Scope"),
          p(val("impacted_units")),
          p(val("stakeholder_groups")),
          p(val("locations")),
          p(val("org_changes")),
          p(val("training_comm")),

        H2("4. Scope Creep Management"),
          p(val("change_process")),
          p(val("impact_assessment")),
          p(val("decision_authority")),
          p(val("positive_scope")),
          p(val("tradeoffs")),

        H2("5. Roles & Responsibilities"),
          p(val("pm_resp")),
          p(val("ba_resp")),
          p(val("techlead_resp")),
          p(val("stakeholders_resp")),
          p(val("gov_body_resp")),

        H2("6. Scoping Checklist"),
          ...checklistRows().flatMap(r => {
            if(r.type === 'h3') return [ H3(r.text) ];
            if(r.type === 'check') return [ p((r.checked ? "☑ " : "☐ ") + r.text) ];
            return [];
          }),

        H2("7. Approval & Sign-off"),
          strongLine("Project Manager — Name", val("sig_pm_name")),
          strongLine("Project Manager — Date", val("sig_pm_date")),
          strongLine("Business Analyst — Name", val("sig_ba_name")),
          strongLine("Business Analyst — Date", val("sig_ba_date")),
          strongLine("Technical Lead — Name", val("sig_tl_name")),
          strongLine("Technical Lead — Date", val("sig_tl_date")),
          strongLine("Business Sponsor — Name", val("sig_bs_name")),
          strongLine("Business Sponsor — Date", val("sig_bs_date")),
      ]
    }]
  });

  const blob = await Packer.toBlob(doc);
  saveAs(blob, "Comprehensive_Scope_Document.docx");
});

/* Clear */
document.getElementById('btnClear').addEventListener('click', ()=>{
  if(!confirm('Clear all fields?')) return;
  document.querySelectorAll('input[type="text"], input[type="date"], textarea').forEach(el=>el.value="");
  document.querySelectorAll('#checklistForm input[type="checkbox"]').forEach(ch=>ch.checked=false);
  syncAll();
});
</script>
</body>
</html>
